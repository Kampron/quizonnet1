import{r}from"./react-0891d0e1.js";var Be=Object.create,me=Object.defineProperty,Je=Object.getOwnPropertyDescriptor,qe=Object.getOwnPropertyNames,ze=Object.getPrototypeOf,_e=Object.prototype.hasOwnProperty,Xe=e=>me(e,"__esModule",{value:!0}),He=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),Ke=(e,n,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of qe(n))!_e.call(e,a)&&a!=="default"&&me(e,a,{get:()=>n[a],enumerable:!(s=Je(n,a))||s.enumerable});return e},Ze=e=>Ke(Xe(me(e!=null?Be(ze(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),We=He((e,n)=>{(function(s,a){typeof e=="object"&&typeof n<"u"?a(e):typeof define=="function"&&define.amd?define(["exports"],a):(s=typeof globalThis<"u"?globalThis:s||self,a(s.fastUniqueNumbers={}))})(e,function(s){var a=function(E){return function(v){var l=E(v);return v.add(l),l}},c=function(E){return function(v,l){return E.set(v,l),l}},T=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,A=536870912,D=A*2,$=function(E,v){return function(l){var y=v.get(l),d=y===void 0?l.size:y<D?y+1:0;if(!l.has(d))return E(l,d);if(l.size<A){for(;l.has(d);)d=Math.floor(Math.random()*D);return E(l,d)}if(l.size>T)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;l.has(d);)d=Math.floor(Math.random()*T);return E(l,d)}},N=new WeakMap,B=c(N),G=$(B,N),V=a(G);s.addUniqueNumber=V,s.generateUniqueNumber=G,Object.defineProperty(s,"__esModule",{value:!0})})});Ze(We());var M=(typeof window>"u"?"undefined":typeof window)=="object",k={setTimeout:M?setTimeout.bind(window):setTimeout,clearTimeout:M?clearTimeout.bind(window):clearTimeout,setInterval:M?setInterval.bind(window):setInterval,clearInterval:M?clearInterval.bind(window):clearInterval};function Ye(e){k.setTimeout=e.setTimeout,k.clearTimeout=e.clearTimeout,k.setInterval=e.setInterval,k.clearInterval=e.clearInterval}var X={},Qe=class{constructor(e){this.closed=!1,this.mc=new MessageChannel,this.name=e,X[e]=X[e]||[],X[e].push(this),this.mc.port1.start(),this.mc.port2.start(),this.onStorage=this.onStorage.bind(this),window.addEventListener("storage",this.onStorage)}onStorage(e){if(e.storageArea!==window.localStorage||e.key.substring(0,this.name.length)!==this.name||e.newValue===null)return;let n=JSON.parse(e.newValue);this.mc.port2.postMessage(n)}postMessage(e){if(this.closed)throw new Error("InvalidStateError");let n=JSON.stringify(e),s=`${this.name}:${String(Date.now())}${String(Math.random())}`;window.localStorage.setItem(s,n),k.setTimeout(()=>{window.localStorage.removeItem(s)},500),X[this.name].forEach(a=>{a!==this&&a.mc.port2.postMessage(JSON.parse(n))})}close(){if(this.closed)return;this.closed=!0,this.mc.port1.close(),this.mc.port2.close(),window.removeEventListener("storage",this.onStorage);let e=X[this.name].indexOf(this);X[this.name].splice(e,1)}get onmessage(){return this.mc.port1.onmessage}set onmessage(e){this.mc.port1.onmessage=e}get onmessageerror(){return this.mc.port1.onmessageerror}set onmessageerror(e){this.mc.port1.onmessageerror=e}addEventListener(e,n){return this.mc.port1.addEventListener(e,n)}removeEventListener(e,n){return this.mc.port1.removeEventListener(e,n)}dispatchEvent(e){return this.mc.port1.dispatchEvent(e)}},et=typeof window>"u"?void 0:typeof window.BroadcastChannel=="function"?window.BroadcastChannel:Qe;function tt(e=0){return new Promise(n=>k.setTimeout(n,e))}function Pe(){return Math.random().toString(36).substring(2)}var u;(function(e){e[e.APPLY=0]="APPLY",e[e.TELL=1]="TELL",e[e.CLOSE=2]="CLOSE",e[e.REGISTER=3]="REGISTER",e[e.DEREGISTER=4]="DEREGISTER",e[e.IDLE=5]="IDLE",e[e.ACTIVE=6]="ACTIVE",e[e.PROMPT=7]="PROMPT",e[e.START=8]="START",e[e.RESET=9]="RESET",e[e.ACTIVATE=10]="ACTIVATE",e[e.PAUSE=11]="PAUSE",e[e.RESUME=12]="RESUME",e[e.MESSAGE=13]="MESSAGE"})(u||(u={}));var rt=class{constructor(e,n){this.token=Pe(),this.isLeader=!1,this.isDead=!1,this.isApplying=!1,this.reApply=!1,this.intervals=[],this.listeners=[],this.channel=e,this.options=n,this.apply=this.apply.bind(this),this.awaitLeadership=this.awaitLeadership.bind(this),this.sendAction=this.sendAction.bind(this)}async apply(){if(this.isLeader||this.isDead)return!1;if(this.isApplying)return this.reApply=!0,!1;this.isApplying=!0;let e=!1,n=s=>{let{token:a,action:c}=s.data;a!==this.token&&(c===u.APPLY&&a>this.token&&(e=!0),c===u.TELL&&(e=!0))};this.channel.addEventListener("message",n);try{return this.sendAction(u.APPLY),await tt(this.options.responseTime),this.channel.removeEventListener("message",n),this.isApplying=!1,e?this.reApply?this.apply():!1:(this.assumeLead(),!0)}catch{return!1}}awaitLeadership(){if(this.isLeader)return Promise.resolve();let e=!1,n=null;return new Promise(s=>{let a=()=>{if(e)return;e=!0,k.clearInterval(n);let T=this.intervals.indexOf(n);this.intervals.splice(T,1),this.channel.removeEventListener("message",c),s()};n=k.setInterval(()=>{this.apply().then(()=>{this.isLeader&&a()})},this.options.fallbackInterval),this.intervals.push(n);let c=T=>{let{action:A}=T.data;A===u.CLOSE&&this.apply().then(()=>{this.isLeader&&a()})};this.channel.addEventListener("message",c)})}sendAction(e){this.channel.postMessage({action:e,token:this.token})}assumeLead(){this.isLeader=!0;let e=n=>{let{action:s}=n.data;s===u.APPLY&&this.sendAction(u.TELL)};return this.channel.addEventListener("message",e),this.listeners.push(e),this.sendAction(u.TELL)}waitForLeadership(){return this.deferred?this.deferred:(this.deferred=this.awaitLeadership(),this.deferred)}close(){this.isDead||(this.isDead=!0,this.isLeader=!1,this.sendAction(u.CLOSE),this.listeners.forEach(e=>this.channel.removeEventListener("message",e)),this.intervals.forEach(e=>k.clearInterval(e)))}},Ce;(function(e){e[e.PROMPTED=0]="PROMPTED",e[e.ACTIVE=1]="ACTIVE",e[e.IDLE=2]="IDLE"})(Ce||(Ce={}));var nt=class{constructor(e){this.token=Pe(),this.registry=new Map,this.allIdle=!1,this.isLastActive=!1;let{channelName:n}=e;if(this.options=e,this.channel=new et(n),this.registry.set(this.token,1),e.leaderElection){let s={fallbackInterval:2e3,responseTime:100};this.elector=new rt(this.channel,s),this.elector.waitForLeadership()}this.channel.addEventListener("message",s=>{let{action:a,token:c,data:T}=s.data;switch(a){case u.REGISTER:this.registry.set(c,2);break;case u.DEREGISTER:this.registry.delete(c);break;case u.IDLE:this.idle(c);break;case u.ACTIVE:this.active(c);break;case u.PROMPT:this.prompt(c);break;case u.START:this.start(c);break;case u.RESET:this.reset(c);break;case u.ACTIVATE:this.activate(c);break;case u.PAUSE:this.pause(c);break;case u.RESUME:this.resume(c);break;case u.MESSAGE:this.options.onMessage(T);break}}),this.send(u.REGISTER)}get isLeader(){if(!this.elector)throw new Error('❌ Leader election is not enabled. To Enable it set the "leaderElection" property to true.');return this.elector.isLeader}prompt(e=this.token){this.registry.set(e,0);let n=[...this.registry.values()].every(s=>s===0);e===this.token&&this.send(u.PROMPT),n&&this.options.onPrompt()}idle(e=this.token){this.registry.set(e,2);let n=[...this.registry.values()].every(s=>s===2);e===this.token&&this.send(u.IDLE),!this.allIdle&&n&&(this.allIdle=!0,this.options.onIdle())}active(e=this.token){this.allIdle=!1,this.registry.set(e,1);let n=[...this.registry.values()].some(s=>s===1);e===this.token&&this.send(u.ACTIVE),n&&this.options.onActive(),this.isLastActive=e===this.token}start(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(u.START):this.options.start(!0),this.isLastActive=e===this.token}reset(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(u.RESET):this.options.reset(!0),this.isLastActive=e===this.token}activate(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(u.ACTIVATE):this.options.activate(!0),this.isLastActive=e===this.token}pause(e=this.token){e===this.token?this.send(u.PAUSE):this.options.pause(!0)}resume(e=this.token){e===this.token?this.send(u.RESUME):this.options.resume(!0)}message(e){try{this.channel.postMessage({action:u.MESSAGE,token:this.token,data:e})}catch{}}send(e){try{this.channel.postMessage({action:e,token:this.token})}catch{}}close(){this.options.leaderElection&&this.elector.close(),this.send(u.DEREGISTER),this.channel.close()}},st=M?document:null,it=["mousemove","keydown","wheel","DOMMouseScroll","mousewheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange","focus"];function ut(e,n){let s;function a(...c){s&&clearTimeout(s),s=setTimeout(()=>{e(...c),s=null},n)}return a.cancel=function(){clearTimeout(s)},a}function fe(e,n){let s=0;return function(...a){let c=new Date().getTime();if(!(c-s<n))return s=c,e(...a)}}var h=()=>Date.now(),H=2147483647;function ot({timeout:e=1e3*60*20,promptTimeout:n=0,promptBeforeIdle:s=0,element:a=st,events:c=it,timers:T=void 0,immediateEvents:A=[],onPresenceChange:D=()=>{},onPrompt:$=()=>{},onIdle:N=()=>{},onActive:B=()=>{},onAction:G=()=>{},onMessage:V=()=>{},debounce:E=0,throttle:v=0,eventsThrottle:l=200,startOnMount:y=!0,startManually:d=!1,stopOnIdle:Q=!1,crossTab:J=!1,name:pe="idle-timer",syncTimers:K=0,leaderElection:Ee=!1}={}){let ve=r.useRef(h()),ee=r.useRef(h()),m=r.useRef(null),b=r.useRef(null),C=r.useRef(0),Z=r.useRef(0),I=r.useRef(0),g=r.useRef(0),o=r.useRef(!1),f=r.useRef(!1),R=r.useRef(!1),P=r.useRef(!0),W=r.useRef(!1),S=r.useRef(null),i=r.useRef(null),w=r.useRef(e),U=r.useRef(0);r.useEffect(()=>{if(n&&console.warn("⚠️ IdleTimer -- The `promptTimeout` property has been deprecated in favor of `promptBeforeIdle`. It will be removed in the next major release."),s&&n)throw new Error("❌ Both promptTimeout and promptBeforeIdle can not be set. The promptTimeout property will be deprecated in a future version.");if(e>=H)throw new Error(`❌ The value for the timeout property must fit in a 32 bit signed integer, ${H}.`);if(n>=H)throw new Error(`❌ The value for the promptTimeout property must fit in a 32 bit signed integer, ${H}.`);if(s>=H)throw new Error(`❌ The value for the promptBeforeIdle property must fit in a 32 bit signed integer, ${H}.`);if(s?(w.current=e-s,U.current=s):(w.current=e,U.current=n),!P.current){if(d)return;o.current&&(q.current(),i.current&&i.current.active()),_()}},[e,n,s,d]);let ge=r.useRef(Q);r.useEffect(()=>{ge.current=Q},[Q]);let Te=r.useRef(A),ie=r.useRef(a),ue=r.useRef([...new Set([...c,...A]).values()]),Y=r.useRef(D);r.useEffect(()=>{Y.current=D},[D]);let te=r.useRef($);r.useEffect(()=>{te.current=$},[$]);let re=r.useRef(N);r.useEffect(()=>{re.current=N},[N]);let q=r.useRef(B);r.useEffect(()=>{q.current=B},[B]);let ne=r.useRef(G);r.useEffect(()=>{ne.current=G},[G]);let z=r.useRef(V);r.useEffect(()=>{z.current=V},[V]);let j=r.useMemo(()=>{let t=p=>ne.current(p);return E>0?ut(t,E):v>0?fe(t,v):t},[v,E]),be=r.useRef();r.useEffect(()=>{J&&K&&(be.current=fe(()=>{i.current.active()},K))},[J,K]);let L=()=>{S.current!==null&&(k.clearTimeout(S.current),S.current=null)},x=(t,p=!0)=>{L(),S.current=k.setTimeout(ce,t||w.current),p&&(b.current=h())},we=t=>{!f.current&&!o.current&&(te.current(t),Y.current({type:"active",prompted:!0})),g.current=0,I.current=h(),f.current=!0,x(U.current,!1)},Le=()=>{L(),o.current||(re.current(),Y.current({type:"idle"})),o.current=!0,m.current=h(),ge.current?F():f.current&&(I.current=0,f.current=!1)},ae=t=>{L(),(o.current||f.current)&&(q.current(t),Y.current({type:"active",prompted:!1})),f.current=!1,I.current=0,o.current=!1,C.current+=h()-m.current,Z.current+=h()-m.current,O(),x()},ce=t=>{if(!o.current){j.cancel&&j.cancel();let p=h()-b.current;if(!(w.current+U.current<p)&&U.current>0&&!f.current){i.current?i.current.prompt():we(t);return}i.current?i.current.idle():Le();return}i.current?i.current.active():ae(t)},oe=t=>{if(!y&&!b.current&&(b.current=h(),q.current()),j(t),f.current)return;if(L(),!o.current&&Te.current.includes(t.type)){ce(t);return}let p=h()-b.current;if(o.current&&!Q||!o.current&&p>=w.current){ce(t);return}R.current=!1,g.current=0,I.current=0,x(),J&&K&&be.current()},se=r.useRef(oe);r.useEffect(()=>{let t=W.current;t&&F(),l>0?se.current=fe(oe,l):se.current=oe,t&&O()},[l,v,E,ne,J,K]);let O=()=>{!M||W.current||(ue.current.forEach(t=>{ie.current.addEventListener(t,se.current,{capture:!0,passive:!0})}),W.current=!0)},F=(t=!1)=>{!M||(W.current||t)&&(ue.current.forEach(p=>{ie.current.removeEventListener(p,se.current,{capture:!0})}),W.current=!1)},_=r.useCallback(t=>{L(),O(),o.current=!1,f.current=!1,R.current=!1,g.current=0,I.current=0,i.current&&!t&&i.current.start(),x()},[S,o,w,i]),le=r.useCallback(t=>{L(),O(),ee.current=h(),C.current+=h()-m.current,Z.current+=h()-m.current,C.current=0,o.current=!1,f.current=!1,R.current=!1,g.current=0,I.current=0,i.current&&!t&&i.current.reset(),d||x()},[S,o,w,d,i]),ke=r.useCallback(t=>{L(),O(),(o.current||f.current)&&ae(),o.current=!1,f.current=!1,R.current=!1,g.current=0,I.current=0,ee.current=h(),i.current&&!t&&i.current.activate(),x()},[S,o,f,w,i]),he=r.useCallback((t=!1)=>R.current?!1:(g.current=Ae(),R.current=!0,F(),L(),i.current&&!t&&i.current.pause(),!0),[S,i]),de=r.useCallback((t=!1)=>R.current?(R.current=!1,f.current||O(),o.current||x(g.current),I.current&&(I.current=h()),i.current&&!t&&i.current.resume(),!0):!1,[S,w,g,i]),Oe=r.useCallback((t,p)=>{i.current?(p&&z.current(t),i.current.message(t)):p&&z.current(t)},[V]),De=r.useCallback(()=>o.current,[o]),Ne=r.useCallback(()=>f.current,[f]),Ge=r.useCallback(()=>i.current?i.current.isLeader:null,[i]),Ve=r.useCallback(()=>i.current?i.current.isLastActive:null,[i]),Ue=r.useCallback(()=>i.current?i.current.token:null,[i]),Ae=r.useCallback(()=>{if(R.current)return g.current;let t=g.current?g.current:U.current+w.current,p=b.current?h()-b.current:0,Me=Math.floor(t-p);return Me<0?0:Math.abs(Me)},[w,U,f,g,b]),ye=r.useCallback(()=>Math.round(h()-ee.current),[ee]),Ie=r.useCallback(()=>Math.round(h()-ve.current),[ve]),je=r.useCallback(()=>m.current?new Date(m.current):null,[m]),xe=r.useCallback(()=>b.current?new Date(b.current):null,[b]),Re=r.useCallback(()=>o.current?Math.round(h()-m.current+C.current):Math.round(C.current),[m,C]),Se=r.useCallback(()=>o.current?Math.round(h()-m.current+Z.current):Math.round(Z.current),[m,Z]),Fe=r.useCallback(()=>{let t=Math.round(ye()-Re());return t>=0?t:0},[m,C]),$e=r.useCallback(()=>{let t=Math.round(Ie()-Se());return t>=0?t:0},[m,C]);return r.useEffect(()=>{if(E>0&&v>0)throw new Error("❌ onAction can either be throttled or debounced, not both.");T&&Ye(T);let t=()=>{i.current&&i.current.close(),j.cancel&&j.cancel(),L(),F(!0)};return M&&window.addEventListener("beforeunload",t),()=>{M&&window.removeEventListener("beforeunload",t),i.current&&i.current.close(),j.cancel&&j.cancel(),L(),F(!0)}},[]),r.useEffect(()=>{i.current&&i.current.close(),J?i.current=new nt({channelName:pe,leaderElection:Ee,onPrompt:()=>{we()},onIdle:()=>{Le()},onActive:()=>{ae()},onMessage:(...t)=>{z.current(...t)},start:_,reset:le,activate:ke,pause:he,resume:de}):i.current=null},[J,pe,Ee,te,re,q,z,_,le,he,de]),r.useEffect(()=>{P.current||(L(),F(!0)),!d&&(y?_():O())},[d,y,P]),r.useEffect(()=>{if(!P.current){let t=[...new Set([...c,...A]).values()];if(F(),ue.current=t,ie.current=a,Te.current=A,d)return;y?_():O()}},[a,JSON.stringify(c),JSON.stringify(A),P,d,y]),r.useEffect(()=>{P.current&&(P.current=!1)},[P]),{message:Oe,start:_,reset:le,activate:ke,pause:he,resume:de,isIdle:De,isPrompted:Ne,isLeader:Ge,isLastActiveTab:Ve,getTabId:Ue,getRemainingTime:Ae,getElapsedTime:ye,getTotalElapsedTime:Ie,getLastIdleTime:je,getLastActiveTime:xe,getIdleTime:Re,getTotalIdleTime:Se,getActiveTime:Fe,getTotalActiveTime:$e,setOnPresenceChange:t=>{D=t,Y.current=t},setOnPrompt:t=>{$=t,te.current=t},setOnIdle:t=>{N=t,re.current=t},setOnActive:t=>{B=t,q.current=t},setOnAction:t=>{G=t,ne.current=t},setOnMessage:t=>{V=t,z.current=t}}}var at=r.createContext(null);at.Consumer;export{ot as r};
